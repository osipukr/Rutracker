@inject AppState AppState
@inject IUriHelper UriHelper
@inject IMatToaster MatToaster

<AuthorizeView>
    <Authorized>
        @if (UserModel != null)
        {
            <div class="drawer-profile">
                <MatIconButton Icon="@MatIconNames.Account_circle" Link="@ProfileLink" />
                <span class="miniHover"><b><a href="@ProfileLink">@UserModel.UserName</a></b></span>
            </div>
        }
    </Authorized>
</AuthorizeView>

@code
{
    [CascadingParameter] private Task<AuthenticationState> AuthenticationStateTask  { get; set; }

    private UserViewModel UserModel { get; set; }

    private const string ProfileLink = "/account/profile";

    protected override async Task OnInitAsync()
    {
        var state = await AuthenticationStateTask;

        if (state.User.Identity.IsAuthenticated)
        {
            try
            {
                UserModel = await AppState.UserDetails();
            }
            catch (Exception ex)
            {
                MatToaster.Add(ex.Message, MatToastType.Warning, "Failed to get user profile");
            }
        }
    }
}