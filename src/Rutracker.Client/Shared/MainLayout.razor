@inherits LayoutComponentBase

@inject ViewSettings ViewSettings

<MatDrawerContainer Style="width: 100vw; height: 100vh;" Class="@_bbDrawerClass">
    <MatDrawer @bind-Opened="@_navMenuOpened">
        <header class="drawer-header">
            <div class="drawer-logo">
                <img alt="@BrandName" class="logo-img" src="img/brand-white.svg" title="@BrandName">
                <a class="miniHover" href="/">@BrandName</a>
            </div>
            <ProfileControl />
        </header>

        <NavMenu />

        <footer class="drawer-footer">
            <MatButton Icon="@MatIconNames.Help" Class="w-100" Link="@RepositoryLink">
                <span class="miniHover">Help & Support</span>
            </MatButton>
        </footer>
    </MatDrawer>
    <MatDrawerContent>
        <MatAppBarContainer>
            <MatAppBar Fixed="true">
                <MatAppBarRow>
                    <MatAppBarSection>
                        <MatAppBarTitle>

                        </MatAppBarTitle>
                        <div class="hidden-mdc-down">
                            <MatTooltip Tooltip="Toggle Navigation" Wrap="true">
                                <MatIconButton Class="navToggle"
                                               Icon="@MatIconNames.Menu"
                                               ToggleIcon="@MatIconNames.Menu"
                                               OnClick="@NavToggleClicked" />
                            </MatTooltip>

                            <MatTooltip Tooltip="Minify Navigation" Wrap="true">
                                <MatIconButton Class="navToggle"
                                               Icon="@MatIconNames.Format_indent_decrease"
                                               ToggleIcon="@MatIconNames.Format_indent_decrease"
                                               OnClick="@NavMinifyClicked" />
                            </MatTooltip>
                        </div>
                    </MatAppBarSection>

                    <MatAppBarSection Align="@MatAppBarSectionAlign.End" Style="padding-right: 1rem;">
                        <MatTooltip Tooltip="Github Repository" Wrap="true">
                            <MatIconButton Link="@RepositoryLink">
                                <i class="fa fa-github" aria-hidden="true"></i>
                            </MatIconButton>
                        </MatTooltip>

                        <LoginControl />
                    </MatAppBarSection>
                </MatAppBarRow>
            </MatAppBar>
            <MatAppBarContent>
                <section class="container-fluid px-4 py-3">
                    @Body
                </section>
            </MatAppBarContent>
        </MatAppBarContainer>
    </MatDrawerContent>
</MatDrawerContainer>

@code
{
    private bool _navMenuOpened = true;
    private bool _navMinified = false;
    private string _bbDrawerClass = string.Empty;

    private string BrandName => ViewSettings.ServiceName;
    private const string RepositoryLink = "https://github.com/osipukr/Rutracker-Blazor";

    private void NavToggleClicked()
    {
        _navMenuOpened = !_navMenuOpened;
        _bbDrawerClass = _navMenuOpened ? "full" : "closed";

        StateHasChanged();
    }

    private void NavMinifyClicked()
    {
        _navMinified = !_navMinified || !_navMenuOpened;

        if (_navMinified)
        {
            _bbDrawerClass = "mini";
            _navMenuOpened = true;
        }
        else if (_navMenuOpened)
        {
            _bbDrawerClass = "full";
        }

        _navMenuOpened = true;

        StateHasChanged();
    }
}